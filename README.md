# Friends

基于 GitHub Issues 和 Actions 的自动化友链管理系统。

## 项目原理

本项目利用 GitHub 原生功能实现友链和赞助的自动化管理：

### 核心组件

| 组件 | 功能 |
|------|------|
| **Issue 模板** | 提供标准化的友链申请表单 |
| **GitHub Actions** | 自动处理友链验证、添加、状态检测 |
| **TypeScript 数据文件** | 存储友链和赞助数据 |

### 工作流程

```
┌─────────────────────────────────────────────────────────────────┐
│                        友链申请流程                              │
├─────────────────────────────────────────────────────────────────┤
│  用户提交 Issue → 关闭 Issue → 自动检测链接 → 验证通过 → 添加友链  │
│                                    ↓                            │
│                              验证失败 → 重新打开 Issue           │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                        友链检测流程                              │
├─────────────────────────────────────────────────────────────────┤
│  每日自动检测 → 发现失联 → 标记 disconnected → 创建/打开 Issue   │
│                                    ↓                            │
│              网站恢复 → 关闭「友链失联」Issue → 移除失联标记       │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                        赞助添加流程                              │
├─────────────────────────────────────────────────────────────────┤
│  Fork 仓库 → 修改 sponsors.json → 提交 PR → 自动验证 → 合并      │
└─────────────────────────────────────────────────────────────────┘
```

## 申请友链

### 方式一：通过 Issue 申请（推荐）

1. 点击 [Issues](../../issues) → New Issue
2. 选择「申请友链」模板
3. 填写以下信息：
   - **网站名称**：您的网站名称
   - **网站描述**：一句话介绍
   - **网站地址**：完整的 URL
   - **头像地址**：头像图片的 URL

4. 提交后关闭 Issue，系统会自动：
   - 检测网站和头像的可访问性（3次重试）
   - 验证通过后自动添加到友链列表
   - 验证失败会重新打开 Issue 并说明原因

### 方式二：通过 PR 提交

请参考 [GitHub PR 提交指南](https://github.com/yxksw/Friends/wiki/Github-PR)

## 添加赞助

赞助信息通过 PR 方式添加：

1. Fork 本仓库
2. 编辑 `data/sponsors.json`，在数组开头添加：
   ```json
   {
     "name": "您的名称",
     "avatar": "头像URL",
     "website": "网站URL（可选）",
     "date": "赞助日期",
     "amount": "赞助金额"
   }
   ```
3. 提交 PR，系统会自动验证：
   - JSON 语法正确性
   - 必填字段完整性
   - 头像和网站链接可达性

详细的 PR 提交流程请参考 [GitHub PR 提交指南](https://github.com/yxksw/Friends/wiki/Github-PR)

## 数据结构

### 友链数据 (`data/friends.ts`)

```typescript
interface FriendLink {
  name: string;          // 网站名称
  description: string;   // 网站描述
  url: string;           // 网站地址
  avatar: string;        // 头像地址
  addDate?: string;      // 添加日期
  recommended?: boolean; // 是否推荐
  disconnected?: boolean;// 是否失联
}
```

### 赞助数据 (`data/sponsors.json`)

```json
{
  "name": "名称",
  "avatar": "头像URL",
  "website": "网站URL",
  "date": "日期",
  "amount": "金额"
}
```

## 自动化功能

| 工作流 | 触发条件 | 功能 |
|--------|----------|------|
| `friend-link-handler.yml` | Issue 关闭 | 验证并添加友链 / 恢复失联友链 |
| `recommended-handler.yml` | 添加 recommended 标签 | 标记推荐友链 |
| `sponsor-validator.yml` | PR 修改 sponsors.json | 验证赞助数据 |
| `check-links.yml` | 每日凌晨 / 手动触发 | 检测友链状态 |

## 标签说明

| 标签 | 用途 |
|------|------|
| `手动通过` | 跳过链接验证，直接添加友链 |
| `recommended` | 标记为推荐友链 |

## 本地开发

```bash
# 安装依赖
npm install

# 运行友链检测
npm run check-links
```

## 许可证

MIT License
